version: "3.7"
services:
  frontapp:
    container_name: frontappcontainer
    build: ./frontdocker
    restart: always
    ports:
      - "4200:80"
    networks:
      - springapimysql-net
    depends_on:
      - api_service
  api_service:
    build: ./eduhublastsbeh
    restart: always
    ports:
      - 8081:8081
    networks:
      - springapimysql-net
    environment:
      - spring.datasource.url=jdbc:mysql://mysqldb:3306/cloudcraft?allowPublicKeyRetrieval=true
      - spring.mail.host=smtp.gmail.com
      - spring.mail.port=587
      - spring.mail.username=nourelhoudachawebi@gmail.com
      - spring.mail.password=tiim odnd ihbc dxgt
      - spring.mail.properties.mail.smtp.auth=true
      - spring.mail.properties.mail.smtp.starttls.enable=true


      # Set maximum request size to 20 MB

      #jwt token props
      - jdj.secure.token.validity=6000
      - site.base.url.https=http://localhost:8081
      - spring.jwt.secret=JwZ0JMDLLO+iqelZ2xAAKKI93pdnJXbApGvNGrj39j7DmbJvniWXMKa2P3y5ibuiMavP8sp5b+1EvwCGf4gSrg==
      - spring.jwt.jwtExpirationInMs=1800000000

    depends_on:
      - mysqldb
    volumes:
      - .m2:/root/.m2

  mysqldb:
    image: "mysql:8.0"
    ports:
      - 3308:3306
    networks:
      - springapimysql-net
    environment:
      MYSQL_DATABASE: cloudcraft
      MYSQL_PASSWORD: root
      MYSQL_ROOT_PASSWORD: root
networks:
  springapimysql-net: